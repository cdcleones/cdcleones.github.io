<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!--<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">-->

<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.css">
<link rel="stylesheet" type="text/css" href="css/animate.css">


<link rel="stylesheet" type="text/css" href="css1/jquery.dataTables.min.css">

<script type="text/javascript" src="js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="js1/jquery.dataTables.min.js"></script>


<script type="text/javascript" src="js/races.js"></script>

<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/jquery-scrolltofixed.js"></script>
<script type="text/javascript" src="js/jquery.nav.js"></script> 
<script type="text/javascript" src="js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="js/jquery.isotope.js"></script>
<script type="text/javascript" src="js/wow.js"></script> 
<script src="contact/jqBootstrapValidation.js"></script>
<script src="contact/contact_me.js"></script>
<script type="text/javascript" src="js/custom.js"></script>

<style type="text/css">
div.carreras{
  background: #fff;
  border: 1px solid #E1E1E8;
  margin: 10px 0;
  padding: 8px;
  color: #000;
}

.btn-red { 
  color: #ffffff; 
  background-color: #DF0031; 
  border-color: #FFFFFF; 
} 
 
.btn-red:focus, .btn-red.active, .open .dropdown-toggle.btn-red { 
  color: #ffffff; 
  background-color: #1e721e; 
  border-color: #FFFFFF; 
} 

.btn-red:hover { 
  color: #ffffff; 
  background-color: #449D44; 
  border-color: #FFFFFF; 
} 
 
.btn-red:active, .btn-red.active, .open .dropdown-toggle.btn-red { 
  background-image: none; 
} 
 
.btn-red.disabled, .btn-red[disabled], fieldset[disabled] .btn-red, 
.btn-red.disabled:hover, .btn-red[disabled]:hover, fieldset[disabled] .btn-red:hover, 
.btn-red.disabled:focus, .btn-red[disabled]:focus, fieldset[disabled] .btn-red:focus, 
.btn-red.disabled:active, .btn-red[disabled]:active, fieldset[disabled] .btn-red:active, 
.btn-red.disabled.active, .btn-red[disabled].active, fieldset[disabled] .btn-red.active { 
  background-color: #DF0031; 
  border-color: #FFFFFF; 
} 
 
.btn-red .badge { 
  color: #DF0031; 
  background-color: #ffffff; 
}

div.infocarrera{
  background: #E7E7E7;
  border: 1px solid #26C300;
  margin: 20px 0;
  padding: 40px;
  color: #000000;
  border-radius: 10px;
}
.dcha{
  text-align: right;
}
.izda{
  text-align: left;
}

div.podium{
  background: #fff;
  border: 1px solid #DF0031;
  margin: 20px 0;
  padding: 40px;
  color: #000;
  border-radius: 10px
}
</style>

<script>

var arrSocios;
var arrConcursos;

function leeSocios(anio){
  var arrTemp = [];
  $.getJSON('socios.txt', function(datosSocios){
	for (var i=0; i<datosSocios.length; i++){
	  if (datosSocios[i].anio==anio){
		var nuevo = {socio:datosSocios[i].socio,nombre:datosSocios[i].nombre,activo:datosSocios[i].activo};
		arrTemp.push(nuevo);
	  }
	}
  });
  return arrTemp;
}

function leeConcursos(anio){
  var arrTemp = [];
  $.getJSON('concursos.txt', function(datosConcursos){
	for (var i=0; i<datosConcursos.length; i++){
	  if (datosConcursos[i].anio==anio){
		var nuevo = {codigo:datosConcursos[i].codigo,nombre:datosConcursos[i].nombre,activo:datosConcursos[i].activo};
		arrTemp.push(nuevo);
	  }
	}
  });
  return arrTemp;
}

function dimeNombreSocio(sSocio){
  for (var i=0; i<arrSocios.length; i++){
	if (arrSocios[i].socio==sSocio){
	  return(arrSocios[i].nombre.toUpperCase());
	}
  }
}

function dimeNombreConcurso(sConcurso){
  for (var i=0; i<arrConcursos.length; i++){
	if (arrConcursos[i].codigo==sConcurso){
	  return(arrConcursos[i].nombre.toUpperCase());
	}
  }
}
$(document).ready(function(){
  
  arrSocios = leeSocios(2018);
  arrConcursos = leeConcursos(2018);
  
  $("#btnbestnac2018").click(function(){
	$.getJSON('carreras.txt', function(datos){
	  var arrPalomas = [];
	  var encontrada;
	  for (var i=0; i<datos.length; i++){
		encontrada=false;
		for (var j=0; j<arrPalomas.length; j++){
		  if (datos[i].anilla==arrPalomas[j].anilla){
			encontrada=true;
			break;
		  }
		}
		if (!encontrada){
		  if (datos[i].concurso.charAt(datos[i].concurso.length-2)=='N'){
			var nueva = {anilla:datos[i].anilla,pais:datos[i].pais,socio:datos[i].socio,misdatos:"<abbr title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</abbr>: "+datos[i].pos+"ª",puntos_reg:datos[i].puntos};
			//var enlace = "<a href='#' data-toggle='tooltip' title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</a>";
			//var nueva = {anilla:datos[i].anilla,pais:datos[i].pais,socio:datos[i].socio,misdatos:enlace+": "+datos[i].pos+"ª",puntos_nac:datos[i].puntos};
			//var nueva = {anilla:datos[i].anilla,pais:datos[i].pais,socio:datos[i].socio,misdatos:datos[i].concurso+": "+datos[i].pos+"ª",puntos_nac:datos[i].puntos};
			arrPalomas.push(nueva);
		  }
		}
		else{
		  if (datos[i].concurso.charAt(datos[i].concurso.length-2)=='N'){
			arrPalomas[j].misdatos+=", <abbr title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</abbr>: "+datos[i].pos+"ª";  
			//var enlace = "<a href='#' data-toggle='tooltip' title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</a>";
			//arrPalomas[j].misdatos+=", "+enlace+": "+datos[i].pos+"ª";
			//arrPalomas[j].misdatos+=", "+datos[i].concurso+": "+datos[i].pos+"ª";
			arrPalomas[j].puntos_nac+=datos[i].puntos;
		  }
		}
	  }
	  //$('[data-toggle="tooltip"]').tooltip();
	  
	  arrPalomas.sort(function (a, b) {
		return b.puntos_nac - a.puntos_nac;
	  });
	  
	  var myTableDiv = document.getElementById("salida");
	  
	  var table = document.createElement('TABLE');
	  table.id='mejorespalomas';
	  table.setAttribute("class", "display");
	  table.style='width:100%';
	  var header = table.createTHead();
	  var row = header.insertRow(0);
	  var cell1 = row.insertCell(0);
	  var cell2 = row.insertCell(1);
	  var cell3 = row.insertCell(1);
	  var cell4 = row.insertCell(1);
	  var cell5 = row.insertCell(1);
	  var cell6 = row.insertCell(1);
	  cell1.innerHTML = "#";
	  cell6.innerHTML = "País";
	  cell5.innerHTML = "Anilla";
	  cell4.innerHTML = "Nombre";
	  cell3.innerHTML = "Posiciones";
	  cell2.innerHTML = "Puntos";
	  var tableBody = document.createElement('TBODY');
	  table.appendChild(tableBody);
	  
	  for (var i=0; i<arrPalomas.length; i++){
		var tr = document.createElement('TR');
		tableBody.appendChild(tr);
		for (var j=0; j<6; j++){
		  var td = document.createElement('TD');
		  switch(j) {
			case 0:
			  td.appendChild(document.createTextNode(i+1));
			  break;
			case 1:
			  td.appendChild(document.createTextNode(arrPalomas[i].pais));
			  break;
			case 2:
			  td.appendChild(document.createTextNode(arrPalomas[i].anilla));
			  break;
			case 3:
			  td.appendChild(document.createTextNode(dimeNombreSocio(arrPalomas[i].socio)));
			  break;
			case 4:
			  td.appendChild(document.createTextNode(arrPalomas[i].misdatos));
			  break;
			case 5:
			  td.appendChild(document.createTextNode(Number(arrPalomas[i].puntos_nac).toFixed(2)));
			  break;
		  } 
		  tr.appendChild(td);
		}
	  }
	  
	  $('#salida').empty();
	  myTableDiv.appendChild(table);
	  
	  $('#mejorespalomas').DataTable( {
		retrieve: true,
		responsive: true,
		paging: true,
		
		"language": {
			"emptyTable": "No hay datos disponibles en la tabla",
			"infoEmpty": "Mostrando 0 a 0 de 0 registros",
            "decimal": ",",
            "thousands": ".",
			"lengthMenu": "Mostrar _MENU_ registros por página",
			"search" : "Buscar",
			"paginate": {
				"first": "Primero",
				"last": "Último",
				"next": "Siguiente",
				"previous": "Anterior"
			},
			"info": "Mostrando página _PAGE_ de _PAGES_",
            "infoFiltered": "(Filtrando de un total de _MAX_ registros)"
        },
		columnDefs: [
			{ targets: [0,5], className: 'dt-body-right' }
		]
	  } );
	
	});
	
  });
  
  $("#btnbestreg2018").click(function(){
	$.getJSON('carreras.txt', function(datos){
	  var arrPalomas = [];
	  var encontrada;
	  for (var i=0; i<datos.length; i++){
		encontrada=false;
		for (var j=0; j<arrPalomas.length; j++){
		  if (datos[i].anilla==arrPalomas[j].anilla){
			encontrada=true;
			break;
		  }
		}
		if (!encontrada){
		  if (datos[i].concurso.charAt(datos[i].concurso.length-2)!='N'){
			//var nueva = {anilla:datos[i].anilla,pais:datos[i].pais,socio:datos[i].socio,misdatos:"<abbr title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</abbr>: "+datos[i].pos+"ª",puntos_reg:datos[i].puntos};
			var nueva = {anilla:datos[i].anilla,pais:datos[i].pais,socio:datos[i].socio,misdatos:datos[i].concurso+": "+datos[i].pos+"ª",puntos_reg:datos[i].puntos};
			arrPalomas.push(nueva);
		  }
		}
		else{
		  if (datos[i].concurso.charAt(datos[i].concurso.length-2)!='N'){
			//arrPalomas[j].misdatos+=", <abbr title='"+dimeNombreConcurso(datos[i].concurso)+"'>"+datos[i].concurso+"</abbr>: "+datos[i].pos+"ª";
			arrPalomas[j].misdatos+=", "+datos[i].concurso+": "+datos[i].pos+"ª";
			arrPalomas[j].puntos_reg+=datos[i].puntos;
		  }
		}
	  }
	  arrPalomas.sort(function (a, b) {
		return b.puntos_reg - a.puntos_reg;
	  });
	  
	  var myTableDiv = document.getElementById("salida");
	  
	  var table = document.createElement('TABLE');
	  table.id='mejorespalomas';
	  table.setAttribute("class", "display");
	  table.style='width:100%';
	  var header = table.createTHead();
	  var row = header.insertRow(0);
	  var cell1 = row.insertCell(0);
	  var cell2 = row.insertCell(1);
	  var cell3 = row.insertCell(1);
	  var cell4 = row.insertCell(1);
	  var cell5 = row.insertCell(1);
	  var cell6 = row.insertCell(1);
	  cell1.innerHTML = "#";
	  cell6.innerHTML = "País";
	  cell5.innerHTML = "Anilla";
	  cell4.innerHTML = "Nombre";
	  cell3.innerHTML = "Posiciones";
	  cell2.innerHTML = "Puntos";
	  var tableBody = document.createElement('TBODY');
	  table.appendChild(tableBody);
	  
	  for (var i=0; i<arrPalomas.length; i++){
		var tr = document.createElement('TR');
		tableBody.appendChild(tr);
		for (var j=0; j<6; j++){
		  var td = document.createElement('TD');
		  switch(j) {
			case 0:
			  td.appendChild(document.createTextNode(i+1));
			  break;
			case 1:
			  td.appendChild(document.createTextNode(arrPalomas[i].pais));
			  break;
			case 2:
			  td.appendChild(document.createTextNode(arrPalomas[i].anilla));
			  break;
			case 3:
			  td.appendChild(document.createTextNode(dimeNombreSocio(arrPalomas[i].socio)));
			  break;
			case 4:
			  td.appendChild(document.createTextNode(arrPalomas[i].misdatos));
			  break;
			case 5:
			  td.appendChild(document.createTextNode(Number(arrPalomas[i].puntos_reg).toFixed(2)));
			  break;
		  } 
		  tr.appendChild(td);
		}
	  }
	  
	  $('#salida').empty();
	  myTableDiv.appendChild(table);

	  $('#mejorespalomas').DataTable( {
		retrieve: true,
		responsive: true,
		paging: true,
		"language": {
			"emptyTable": "No hay datos disponibles en la tabla",
			"infoEmpty": "Mostrando 0 a 0 de 0 registros",
            "decimal": ",",
            "thousands": ".",
			"lengthMenu": "Mostrar _MENU_ registros por página",
			"search" : "Buscar",
			"paginate": {
				"first": "Primero",
				"last": "Último",
				"next": "Siguiente",
				"previous": "Anterior"
			},
			"info": "Mostrando página _PAGE_ de _PAGES_",
            "infoFiltered": "(Filtrando de un total de _MAX_ registros)"
        },
		columnDefs: [
			{ targets: [0,5], className: 'dt-body-right' }
		]
	  } );
	
	});
  });

});


</script>

<style type="text/css">
#container
{
  width:80%;
  margin-left:10%;
}
</style>

</head>
<body>
<br /><br />
<div class="container">
  <button type='button' class='btn btn-lg btn-red enabled' id='btnbestnac2018'>Mejor paloma nacional</button>
  <button type='button' class='btn btn-lg btn-red enabled' id='btnbestreg2018'>Mejor paloma regional</button>
  <br /><br />
  <div id="salida"></div>
</div>

<br /><br /><br />


</body>
</html>
